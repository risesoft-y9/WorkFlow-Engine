/*------------------------------------------------------*/
/*                   修改控件的配置信息                                                                    */
/*                   version:1.7.1                      */
/*                   number:001                         */
/*------------------------------------------------------*/
//64位控件的calssid
var classidx64="A64E3073-2016-4baf-A89D-FFE1FAA10EF1";
//32位控件的classid
var classid="A64E3073-2016-4baf-A89D-FFE1FAA10ED1";
//32位控件包的路径
var codebase="${ctx}/static/tags/cab/ofctnewclsid.cab";
//64位控件包的路径
var codebase64="${ctx}/static/tags/cab/ofctnewclsidx64.cab";
//设置高度
var height="92vh";
//设置宽度主密钥参数:

var width="100%";
//买断授权密钥如果不是买断可以不用写
var MakerCaption="北京有生博大软件股份有限公司"; 
//买断授权密钥如果不是买断可以不用写
var MakerKey="0E56F711A081560070F9D8BF11F3ACC4BCBB2E8E";
//密钥
var ProductCaption="北京有生博大软件股份有限公司";
//密钥
var ProductKey="40FA13E218BA84009D94C067EC55A13F2C1BCDBC";

var downLoadFile = '或者下载安装<a href="'+ctx+'/static/tags/exe/risesoftNTKOWord.exe">跨浏览器插件</a>';

//跨浏览器调用密钥参数:ProductCaption:"南海区政府内部专用",ProductKey:"BFEB1527A7C41CFF0737DA53F0D82FC5A49E5A8E"


/*------------------------------------------------------*/
/*             以下内容 请勿修改，否则可能出错                                            */
/*------------------------------------------------------*/

	var userAgent = navigator.userAgent, 
				rMsie = /(msie\s|trident.*rv:)([\w.]+)/, 
				rFirefox = /(firefox)\/([\w.]+)/, 
				rOpera = /(opera).+version\/([\w.]+)/, 
				rChrome = /(chrome)\/([\w.]+)/, 
				rSafari = /version\/([\w.]+).*(safari)/;
				var browser;
				var version;
				var ua = userAgent.toLowerCase();
				function uaMatch(ua) {
					var match = rMsie.exec(ua);
					if (match != null) {
						return { browser : "IE", version : match[2] || "0" };
					}
					var match = rFirefox.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rOpera.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rChrome.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rSafari.exec(ua);
					if (match != null) {
						return { browser : match[2] || "", version : match[1] || "0" };
					}
					if (match != null) {
						return { browser : "", version : "0" };
					}
				}
				var browserMatch = uaMatch(userAgent.toLowerCase());
				if (browserMatch.browser) {
					browser = browserMatch.browser;
					version = browserMatch.version;
				}
				
/*
谷歌浏览器事件接管
*/
function ntkosavetourl(type,code,html)
{
	//alert("SaveToURL成功回调");
}


function ntkopublishashtml(type,code,html){
	//alert("Onpublishashtmltourl成功回调");
}
function ntkopublishaspdf(type,code,html){
//alert("Onpublishaspdftourl成功回调");
}
function ntkosaveasotherurl(type,code,html){
//alert("SaveAsOtherformattourl成功回调");
}

function ntkoondocumentopened(type,code){
	//alert("Ondocumentopened成功回调");

}
if (browser=="IE"){
	if(window.navigator.platform=="Win32"){
	  
		document.write('<!-- 用来产生编辑状态的ActiveX控件的JS脚本-->   ');
		document.write('<!-- 因为微软的ActiveX新机制，需要一个外部引入的js-->   ');
		document.write('<object id="riseOffice" classid="clsid:'+classid+'"');
		document.write('codebase="'+codebase+'" style="width:'+width+';height:'+height+'">   ');		
		document.write('<param name="MakerCaption" value="'+MakerCaption+'">   ');
		document.write('<param name="MakerKey" value="'+MakerKey+'">   ');
		document.write('<param name="ProductCaption" value="'+ProductCaption+'">   ');
		document.write('<param name="ProductKey" value="'+ProductKey+'">   ');	
		document.write('<param name="IsUseUTF8URL" value="-1">   ');
		document.write('<param name="IsUseUTF8Data" value="-1">   ');
		document.write('<param name="Toolbars" value="0">   ');
		document.write('<param name="TitleBar" value="0">   ');
		document.write('<param name="BorderStyle" value="0">   ');
		document.write('<param name="MenubarColor" value="14607077">   ');
		document.write('<param name="TitlebarColor" value="14607077">   ');
		document.write('<param name="Caption" value="NTKO OFFICE文档控件示例演示 http://www.ntko.com">   ');
		document.write('<SPAN STYLE="color:red">不能装载文档控件。请在检查浏览器的选项中检查浏览器的安全设置。'+downLoadFile+'</SPAN>   ');
		document.write('</object>');	
	}
	if(window.navigator.platform=="Win64"){

		document.write('<!-- 用来产生编辑状态的ActiveX控件的JS脚本-->   ');
		document.write('<!-- 因为微软的ActiveX新机制，需要一个外部引入的js-->   ');
		document.write('<object id="riseOffice" classid="clsid:'+classidx64+'"');
		document.write('codebase="'+codebase64+'" style="width:'+width+';height:'+height+'">   ');
		document.write('<param name="MakerCaption" value="'+MakerCaption+'">   ');
		document.write('<param name="MakerKey" value="'+MakerKey+'">   ');
		document.write('<param name="ProductCaption" value="'+ProductCaption+'">   ');
		document.write('<param name="ProductKey" value="'+ProductKey+'">   ');	
		document.write('<param name="IsUseUTF8URL" value="-1">   ');
		document.write('<param name="IsUseUTF8Data" value="-1">   ');
		document.write('<param name="Toolbars" value="0">   ');
		document.write('<param name="TitleBar" value="0">   ');
		document.write('<param name="BorderStyle" value="0">   ');
		document.write('<param name="MenubarColor" value="14607077">   ');
		document.write('<param name="TitlebarColor" value="14607077">   ');
		document.write('<param name="Caption" value="NTKO OFFICE文档控件示例演示 http://www.ntko.com">   ');
		document.write('<SPAN STYLE="color:red">不能装载文档控件。请在检查浏览器的选项中检查浏览器的安全设置。'+downLoadFile+'</SPAN>   ');
		document.write('</object>');			
	}	
}
else if (browser=="firefox"){ 	
		document.write('<object id="riseOffice" type="application/ntko-plug"  codebase="'+codebase+'" style="width:'+width+';height:'+height+'" ForOnSaveToURL="OnSaveToURL" ForOnAddTemplateFromURL="OnAddTemplateFromURL" ForOndocumentopened="setFileReadOnly" ForOnPublishAsPDFToURL="openToPDFCallBack"');		
		//document.write('ForOnpublishAshtmltourl="ntkopublishashtml"');
		//document.write('ForOnpublishAspdftourl="ntkopublishaspdf"');
		//document.write('ForOnSaveAsOtherFormatToUrl="ntkosaveasotherurl"');	
		document.write('_MakerCaption="'+MakerCaption+'"  ');
		document.write('_MakerKey="'+MakerKey+'"  ');
		document.write('_ProductCaption="'+ProductCaption+'"  ');
		document.write('_ProductKey="'+ProductKey+'"   ');
		document.write('_Toolbars=0   ');
		document.write('_TitleBar=0   ');
		document.write('_BorderStyle=0  ');
		document.write('_MenubarColor=14607077   ');
		document.write('_TitlebarColor=14607077   ');
		document.write('clsid="{'+classid+'}" >');
		document.write('<SPAN STYLE="color:red">尚未安装NTKO Web FireFox跨浏览器插件。'+downLoadFile+'</SPAN>   ');
		document.write('</object>   ');
}else if(browser=="chrome"){
		document.write('<object id="riseOffice" clsid="{'+classid+'}" ForOnSaveToURL="OnSaveToURL" ForOnAddTemplateFromURL="OnAddTemplateFromURL" ForOndocumentopened="setFileReadOnly" ForOnPublishAsPDFToURL="openToPDFCallBack"');
		document.write('ForOnpublishAshtmltourl="ntkopublishashtml"');
		document.write('ForOnpublishAspdftourl="ntkopublishaspdf"');
		document.write('ForOnSaveAsOtherFormatToUrl="ntkosaveasotherurl"');
		document.write('_IsUseUTF8URL="-1"   ');
		document.write('_IsUseUTF8Data="-1"   ');
		document.write('_MakerCaption="'+MakerCaption+'"  ');
		document.write('_MakerKey="'+MakerKey+'"  ');
		document.write('_ProductCaption="'+ProductCaption+'"  ');
		document.write('_ProductKey="'+ProductKey+'"   ');	
		document.write('_Toolbars=0   ');
		document.write('_TitleBar=0   ');
		document.write('_BorderStyle=0  ');
		document.write('_MenubarColor=14607077   ');
		document.write('_TitlebarColor=14607077   ');
		document.write('codebase="'+codebase+'" style="width:'+width+';height:'+height+'" type="application/ntko-plug" ');
		document.write('<SPAN STYLE="color:red">尚未安装NTKO Web Chrome跨浏览器插件。'+downLoadFile+'</SPAN>   ');
		document.write('</object>');
	}else if (Sys.opera){
		alert("sorry,ntko web印章暂时不支持opera!");
	}else if (Sys.safari){
		 alert("sorry,ntko web印章暂时不支持safari!");
	}
//触发跨浏览插件的方法
//ie关闭方法


/*window.onunload =function(){
	window.opener.ntkoCloseEvent();	
}*/

//ie,谷歌，火狐传值
var ntkoBrowser={
		ntkoSetReturnValueToParentPage:function(data1,text1){
			try{
				window.external.SetReturnValueToParentPage(	data1,text1);
			}catch(err){
				if(browser=="IE"){					
				window.opener.ieattachEventntko(data1,text1);
				//window.opener.postMessage({type:"ntkowordie",text:'{"ntkodata":"'+data1+'","ntkotext":"'+text1+'"}'},"*");										
				}
			}	
		}
		
}

