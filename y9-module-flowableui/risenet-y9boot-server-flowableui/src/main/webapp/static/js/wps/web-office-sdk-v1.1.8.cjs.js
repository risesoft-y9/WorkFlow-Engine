"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function __awaiter(e,t,n,a){return new(n||(n=Promise))(function(r,i){function s(e){try{c(a.next(e))}catch(e){i(e)}}function o(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,o)}c((a=a.apply(e,t||[])).next())})}function __generator(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}var officeTypes,officeNameTypes,modeTypes,fullScreenStatus,Message=function(){function e(){}return e.add=function(t){e.HANDLE_LIST.push(t),window.addEventListener("message",t,!1)},e.remove=function(t){var n=e.HANDLE_LIST.indexOf(t);n>=0&&e.HANDLE_LIST.splice(n,1),window.removeEventListener("message",t,!1)},e.empty=function(){for(;e.HANDLE_LIST.length;)window.removeEventListener("message",e.HANDLE_LIST.shift(),!1)},e.parse=function(e){return"object"==typeof e?e:e?JSON.parse(e):e},e.HANDLE_LIST=[],e}();function isPlainObject(e){if(!e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function isFunction(e){return"[object Function]"==={}.toString.call(e)}function dispatchFullScreenChange(e){["fullscreen","fullscreenElement"].forEach(function(t){Object.defineProperty(document,t,{get:function(){return!!e.status},configurable:!0})});var t=new CustomEvent("fullscreenchange");document.dispatchEvent(t)}function addStylesheetRules(e){var t=document.createElement("style");document.head.appendChild(t);var n=t.sheet;n.insertRule(e,n.cssRules.length)}function makeId(){var e=0;return function(){return e+=1}}!function(e){e.unknown="unknown",e.spreadsheet="s",e.writer="w",e.presentation="p",e.pdf="f"}(officeTypes||(officeTypes={})),function(e){e.wps="w",e.et="s",e.presentation="p",e.pdf="f"}(officeNameTypes||(officeNameTypes={})),function(e){e.nomal="nomal",e.simple="simple"}(modeTypes||(modeTypes={})),function(e){e[e.requestFullscreen=1]="requestFullscreen",e[e.exitFullscreen=0]="exitFullscreen"}(fullScreenStatus||(fullScreenStatus={}));var iframe,getId=makeId(),getIframe=function(e,t,n){void 0===n&&(n=!0);var a=t;if(!iframe){var r=handleMountResize.bind(null,a);(iframe=document.createElement("iframe")).classList.add("web-office-iframe");var i={id:"office-iframe",src:e,scrolling:"no",frameborder:"0",allowfullscreen:"allowfullscreen",webkitallowfullscreen:"true",mozallowfullscreen:"true"};for(var s in a?(i.style="width: "+a.clientWidth+"px; height: "+a.clientHeight+"px;",n&&window.addEventListener("resize",r)):((a=document.createElement("div")).classList.add("web-office-default-container"),addStylesheetRules(".web-office-default-container {position: absolute; padding: 0;  margin: 0; width: 100vw; height: 100vh; left: 0; top: 0;}"),document.body.appendChild(a),i.style="width: 100vw; height: 100vh;"),i)iframe.setAttribute(s,i[s]);a.appendChild(iframe),iframe.destroy=function(){iframe.parentNode.removeChild(iframe),iframe=null,window.removeEventListener("resize",r)}}return iframe};function handleMountResize(e){iframe.style.cssText+="height: "+e.clientHeight+"px; width: "+e.clientWidth+"px"}var sendMsgToWps=function(e){getIframe().contentWindow.postMessage(JSON.stringify(e),"*")};function apiSender(e,t,n){return new Promise(function(a){var r=getId(),i=function(e){var t=Message.parse(e.data);t.eventName===n&&t.msgId===r&&(a(t.data),Message.remove(i))};Message.add(i),sendMsgToWps({data:e,msgId:r,eventName:t})})}var apiChannelOld=function(e){return apiSender(e,"wps.jssdk.api","wps.api.reply")},apiBasicChannel=function(e){return apiSender(e,"api.basic","api.basic.reply")},setterCallbacks={idMap:{}};function setterCallbackSubscribe(e){return __awaiter(this,void 0,void 0,function(){var t,n,a,r,i,s,o,c,l,u;return __generator(this,function(d){switch(d.label){case 0:return t=Message.parse(e.data),n=t.eventName,a=t.callbackId,r=t.data,a?(i=setterCallbacks.idMap[a])?(s=i.split(":"),o=s[0],c=s[1],"api.callback"===n&&setterCallbacks[o]&&setterCallbacks[o][c]?[4,(u=setterCallbacks[o][c]).callback.apply(u,r.args)]:[3,2]):[3,2]:[3,2];case 1:l=d.sent(),sendMsgToWps({result:l,callbackId:a,eventName:"api.callback.reply"}),d.label=2;case 2:return[2]}})})}var handleApiSetter=function(e){return __awaiter(void 0,void 0,void 0,function(){function t(){return Object.keys(setterCallbacks.idMap).find(function(e){return setterCallbacks.idMap[e]===a+":"+n})}var n,a,r,i,s,o,c,l,u;return __generator(this,function(d){switch(d.label){case 0:return n=e.prop,a=e.parentObjId,[4,reduceArgs([r=e.value])];case 1:return i=d.sent(),s=i[0],o=i[1],e.value=s[0],c=Object.keys(o)[0],l=setterCallbacks[a],null===r&&l&&l[n]&&((u=t())&&delete setterCallbacks.idMap[u],delete l[n],Object.keys(l).length||delete setterCallbacks[a],Object.keys(setterCallbacks.idMap).length||Message.remove(setterCallbackSubscribe)),c&&(Object.keys(setterCallbacks.idMap).length||Message.add(setterCallbackSubscribe),setterCallbacks[a]||(setterCallbacks[a]={}),setterCallbacks[a][n]={callbackId:c,callback:o[c]},(u=t())&&delete setterCallbacks.idMap[u],setterCallbacks.idMap[c]=a+":"+n),[2]}})})},apiChannel=function(e,t,n,a){return __awaiter(void 0,void 0,void 0,function(){var r,i,s,o,c,l,u,d;return __generator(this,function(f){switch(f.label){case 0:return r=getId(),o=new Promise(function(e,t){i=e,s=t}),c={},t.args?[4,reduceArgs(t.args)]:[3,2];case 1:l=f.sent(),u=l[0],d=l[1],t.args=u,c=d,f.label=2;case 2:return"api.setter"!==e?[3,4]:[4,handleApiSetter(t)];case 3:f.sent(),f.label=4;case 4:return handleSendApiChannel([{eventName:e,data:t,msgId:r},function(){var t=this,l=function(o){return __awaiter(t,void 0,void 0,function(){var t,u,d;return __generator(this,function(f){switch(f.label){case 0:return"api.callback"===(t=Message.parse(o.data)).eventName&&t.callbackId&&c[t.callbackId]?[4,c[t.callbackId].apply(c,t.data.args)]:[3,2];case 1:u=f.sent(),sendMsgToWps({result:u,eventName:"api.callback.reply",callbackId:t.callbackId}),f.label=2;case 2:return t.eventName===e+".reply"&&t.msgId===r&&(t.error?((d=new Error("")).stack=t.error+"\n"+n,a&&a(),s(d)):i(t.result),Message.remove(l)),[2]}})})};return Message.add(l),o}]),[2,o]}})})};function reduceArgs(e){return __awaiter(this,void 0,void 0,function(){var t,n,a,r,i,s,o,c,l,u,d;return __generator(this,function(f){switch(f.label){case 0:t={},n=[],a=e.slice(0),f.label=1;case 1:return a.length?(r=void 0,[4,a.shift()]):[3,13];case 2:return(i=f.sent())&&i.done?[4,i.done()]:[3,4];case 3:f.sent(),f.label=4;case 4:if(!isPlainObject(r))return[3,11];for(o in r={},s=[],i)s.push(o);c=0,f.label=5;case 5:return c<s.length?(l=s[c],u=i[l],/^[A-Z]/.test(l)?u&&u.done?[4,u.done()]:[3,7]:[3,8]):[3,10];case 6:f.sent(),f.label=7;case 7:u&&u.objId?u={objId:u.objId}:"function"==typeof u&&(d=getId(),t[d]=u,u={callbackId:d}),f.label=8;case 8:r[l]=u,f.label=9;case 9:return c++,[3,5];case 10:return[3,12];case 11:i&&i.objId?r={objId:i.objId}:"function"==typeof i&&void 0===i.objId?(d=getId(),t[d]=i,r={callbackId:d}):r=i,f.label=12;case 12:return n.push(r),[3,1];case 13:return[2,[n,t]]}})})}function handleSendApiChannel(e){var t=e[0],n=e[1];"function"==typeof(t=__assign({},t)).data&&(t.data=t.data()),n(),sendMsgToWps(t)}var userConfHandler=function(e,t){void 0===t&&(t=!0);var n=__assign({},e),a=n.headers,r=void 0===a?{}:a,i=n.subscriptions,s=void 0===i?{}:i,o=n.mode,c=void 0===o?modeTypes.nomal:o,l=n.commonOptions,u=r.backBtn,d=void 0===u?{}:u,f=r.shareBtn,p=void 0===f?{}:f,b=r.otherMenuBtn,h=void 0===b?{}:b,v=function(e,n){e.subscribe&&"function"==typeof e.subscribe&&(e.callback=n,s[n]=e.subscribe,t&&delete e.subscribe)};if(v(d,"wpsconfig_back_btn"),v(p,"wpsconfig_share_btn"),v(h,"wpsconfig_other_menu_btn"),h.items&&Array.isArray(h.items)){var g=[];h.items.forEach(function(e,t){switch(void 0===e&&(e={}),e.type){case"export_img":e.type=1,e.callback="export_img";break;case"export_pdf":e.type=1,e.callback="export_pdf";break;case"save_version":e.type=1,e.callback="save_version";break;case"about_wps":e.type=1,e.callback="about_wps";break;case"split_line":e.type=2;break;case"custom":e.type=3,v(e,"wpsconfig_other_menu_btn_"+t),g.push(e)}}),g.length&&(isMobile||isInMiniProgram)&&(h.items=g)}n.url=n.url||n.wpsUrl;var m=[];if((c===modeTypes.simple||l&&!1===l.isShowTopArea)&&m.push("simple","hidecmb"),n.debug&&m.push("debugger"),n.url&&m.length&&(n.url=n.url+(n.url.indexOf("?")>=0?"&":"?")+m.join("&")),l&&(l.isParentFullscreen||l.isBrowserViewFullscreen)&&document.addEventListener("fullscreenchange",handleFullscreenChange),n.wordOptions&&(n.wpsOptions=n.wordOptions),n.excelOptions&&(n.etOptions=n.excelOptions),n.pptOptions&&(n.wppOptions=n.pptOptions),"object"==typeof s.print){var _="wpsconfig_print";"function"==typeof s.print.subscribe&&(s[_]=s.print.subscribe,n.print={callback:_},void 0!==s.print.custom&&(n.print.custom=s.print.custom)),delete s.print}"function"==typeof s.exportPdf&&(s[_="wpsconfig_export_pdf"]=s.exportPdf,n.exportPdf={callback:_},delete s.exportPdf);return n.commandBars&&setCommandBars(n.commandBars,!1),__assign(__assign({},n),{subscriptions:s})},getOfficeType=function(e){void 0===e&&(e="");var t="";if(!t&&e){var n=e.toLowerCase();-1!==n.indexOf("/office/s/")&&(t=officeTypes.spreadsheet),-1!==n.indexOf("/office/w/")&&(t=officeTypes.writer),-1!==n.indexOf("/office/p/")&&(t=officeTypes.presentation),-1!==n.indexOf("/office/f/")&&(t=officeTypes.pdf)}if(!t){var a=e.match(/[\?&]type=([a-z]+)/)||[];t=officeNameTypes[a[1]]||""}return t};function setCommandBars(e,t){void 0===t&&(t=!0);var n=e.map(function(e){var t=e.attributes;if(!Array.isArray(t)){var n=[];for(var a in t)if(t.hasOwnProperty(a)){var r={name:a,value:t[a]};n.push(r)}e.attributes=n}return e});return t&&sendMsgToWps({data:n,eventName:"setCommandBars"}),n}var agent=window.navigator.userAgent.toLowerCase(),isMobile=/Android|webOS|iPhone|iPod|BlackBerry|iPad/i.test(agent),isInMiniProgram=function(){try{return-1!==window._parent.location.search.indexOf("from=wxminiprogram")}catch(e){return!1}}();function handleFullscreenChange(){var e={status:fullScreenStatus.requestFullscreen};document.fullscreenElement?e.status=fullScreenStatus.requestFullscreen:e.status=fullScreenStatus.exitFullscreen,sendMsgToWps({data:e,eventName:"fullscreenchange"})}function mitt(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map(function(e){e(n)}),(e["*"]||[]).slice().map(function(e){e(t,n)})}}}var objId=0,collectObjIdHandlers=new Set;function createObjId(e){return objId+=1,!e&&collectObjId(objId),objId}function collectObjId(e){collectObjIdHandlers.forEach(function(t){return t(e)})}function makeCollectObjIdHandle(e){return function(){var t=[],n=function(e){t.push(e)};return collectObjIdHandlers.add(n),{End:function(){e(t),collectObjIdHandlers.delete(n)}}}}function destroyApplication(){collectObjIdHandlers=new Set,objId=0}function initApplication(e,t){var n=this,a=t.Events,r=t.Enum,i=t.Props,s=i[0],o=i[1],c={objId:objId};switch(assign(c,s,o),c.Events=a,c.Enum=r,e.Enum=c.Enum,e.Events=c.Events,e.Props=i,getOfficeType(e.url)){case officeTypes.writer:e.WordApplication=e.WpsApplication=function(){return c};break;case officeTypes.spreadsheet:e.ExcelApplication=e.EtApplication=function(){return c};break;case officeTypes.presentation:e.PPTApplication=e.WppApplication=function(){return c};break;case officeTypes.pdf:e.PDFApplication=function(){return c}}e.Application=c,e.Free=function(e){return apiChannel("api.free",{objId:e},"")},e.Stack=c.Stack=makeCollectObjIdHandle(function(t){e&&e.Free(t)});var l={};Message.add(function(e){return __awaiter(n,void 0,void 0,function(){var t,n,a,r,i;return __generator(this,function(s){switch(s.label){case 0:return"api.event"===(t=Message.parse(e.data)).eventName&&t.data?(n=t.data,a=n.eventName,r=n.data,(i=l[a])?[4,i(r)]:[3,2]):[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})}),c.Sub={};var u=function(e){var t=a[e];Object.defineProperty(c.Sub,t,{set:function(e){l[t]=e,sendMsgToWps({eventName:"api.event.register",data:{eventName:t,register:!!e,objId:objId+=1}})}})};for(var d in a)u(d)}var polyfillApi=["ExportAsFixedFormat","GetOperatorsInfo","ImportDataIntoFields","ReplaceText","ReplaceBookmark","GetBookmarkText","GetComments"];function assign(e,t,n){for(var a=t.slice(0),r=function(){var t=a.shift();!t.alias&&~polyfillApi.indexOf(t.prop)&&a.push(__assign(__assign({},t),{alias:t.prop+"Async"})),Object.defineProperty(e,t.alias||t.prop,{get:function(){var a=this,r=1===t.cache,i=r&&this["__"+t.prop+"CacheValue"];if(!i){var s=new Error("").stack.split("\n").slice(2).join("\n"),o=createObjId(r),c=function(){for(var a,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return void 0!==t.caller?assign(a={objId:createObjId()},n[t.caller],n):a={},wrapper(c,a,"api.caller",{obj:c,args:r,parentObjId:e.objId,objId:a.objId,prop:t.prop},s),a};return c.objId=-1,void 0!==t.getter&&(c.objId=o,assign(c,n[t.getter],n)),wrapper(e,c,"api.getter",{parentObjId:e.objId,objId:c.objId,prop:t.prop},s,function(){delete a["__"+t.prop+"CacheValue"]}),r&&(this["__"+t.prop+"CacheValue"]=c),c}return i},set:function(n){var a=new Error("").stack.split("\n").slice(2).join("\n");return wrapper(e,{},"api.setter",{value:n,parentObjId:e.objId,objId:-1,prop:t.prop},a)}})};a.length;)r()}function wrapper(e,t,n,a,r,i){var s,o=(e.done?e.done():Promise.resolve()).then(function(){return s||(s=apiChannel(n,a,r,i)),s});t.done=function(){return o},t.then=function(e,n){return a.objId>=0?(t.then=null,t.catch=null,e(t)):o.then(e,n)},t.catch=function(e){return o.catch(e)},t.Destroy=function(){return apiChannel("api.free",{objId:t.objId},"")}}var sdkInstance=null,EVENT_TYPES={fileOpen:"fileOpen",tabSwitch:"tabSwitch",fileSaved:"fileSaved",fileStatus:"fileStatus",fullscreenChange:"fullscreenChange",error:"error",stage:"stage"},EVENT_NAME={getToken:"api.getToken",onToast:"event.toast",onHyperLinkOpen:"event.hyperLinkOpen",getClipboardData:"api.getClipboardData"};function listener(e,t,n,a,r,i,s){var o=this;void 0===n&&(n={});Message.add(function(c){return __awaiter(o,void 0,void 0,function(){var o,l,u,d,f,p,b,h,v,g,m,_,w,y,k,E,T,I;return __generator(this,function(C){switch(C.label){case 0:return o=Message.parse(c.data),l=o.eventName,u=void 0===l?"":l,d=o.data,f=void 0===d?null:d,p=o.url,b=void 0===p?null:p,-1!==["wps.jssdk.api"].indexOf(u)?[2]:"ready"!==u?[3,1]:(sendMsgToWps({eventName:"setConfig",data:__assign(__assign({},n),{version:e.version})}),e.tokenData&&e.setToken(__assign(__assign({},e.tokenData),{hasRefreshTokenConfig:!!n.refreshToken})),r.apiReadySended&&sendMsgToWps({eventName:"api.ready"}),e.iframeReady=!0,[3,17]);case 1:return"error"!==u?[3,2]:(t.emit(EVENT_TYPES.error,f),[3,17]);case 2:return"open.result"!==u?[3,3]:(t.emit(EVENT_TYPES.fileOpen,f),[3,17]);case 3:return"file.saved"!==u?[3,4]:(t.emit(EVENT_TYPES.fileStatus,f),t.emit(EVENT_TYPES.fileSaved,f),[3,17]);case 4:return"tab.switch"!==u?[3,5]:(t.emit(EVENT_TYPES.tabSwitch,f),[3,17]);case 5:return"api.scroll"!==u?[3,6]:(window.scrollTo(f.x,f.y),[3,17]);case 6:if(u!==EVENT_NAME.getToken)return[3,11];h={token:!1},C.label=7;case 7:return C.trys.push([7,9,,10]),[4,r.refreshToken()];case 8:return h=C.sent(),[3,10];case 9:return v=C.sent(),console.error("refreshToken: "+(v||"fail to get")),[3,10];case 10:return sendMsgToWps({eventName:EVENT_NAME.getToken+".reply",data:h}),[3,17];case 11:if(u!==EVENT_NAME.getClipboardData)return[3,16];g={text:"",html:""},C.label=12;case 12:return C.trys.push([12,14,,15]),[4,r.getClipboardData()];case 13:return g=C.sent(),[3,15];case 14:return m=C.sent(),console.error("getClipboardData: "+(m||"fail to get")),[3,15];case 15:return sendMsgToWps({eventName:EVENT_NAME.getClipboardData+".reply",data:g}),[3,17];case 16:u===EVENT_NAME.onToast?r.onToast(f):u===EVENT_NAME.onHyperLinkOpen?r.onHyperLinkOpen(f):"stage"===u?t.emit(EVENT_TYPES.stage,f):"event.callback"===u?(_=f.eventName,w=f.data,y=_,"fullScreenChange"===_&&(y=EVENT_TYPES.fullscreenChange),((null===(T=n.commonOptions)||void 0===T?void 0:T.isBrowserViewFullscreen)||(null===(I=n.commonOptions)||void 0===I?void 0:I.isParentFullscreen))&&"fullscreenchange"===y?(k=w.status,E=w.isDispatchEvent,n.commonOptions.isBrowserViewFullscreen?handleBrowserViewFullscreen(k,i,s,E):n.commonOptions.isParentFullscreen&&handleParenFullscreenEvent(k,i),t.emit(y,w)):t.emit(y,w)):"api.ready"===u&&initApplication(e,f),C.label=17;case 17:return"function"==typeof a[u]&&a[u](e,b||f),[2]}})})})}function makeReady(e){return new Promise(function(t){var n=function(a){Message.parse(a.data).eventName===e&&(t(),Message.remove(n))};Message.add(n)})}function config(e){void 0===e&&(e={}),sdkInstance&&sdkInstance.destroy();try{var t=userConfHandler(e),n=t.subscriptions,a=void 0===n?{}:n,r=t.mount,i=void 0===r?null:r,s=t.url,o=t.refreshToken,c=t.onToast,l=t.onHyperLinkOpen,u=t.getClipboardData,d=getIframe(s,i),f=makeReady("ready"),p=makeReady("open.result"),b=makeReady("api.ready"),h=i?{width:i.clientWidth+"px",height:i.clientHeight+"px"}:{width:"100vw",height:"100vh"};delete t.mount,s&&delete t.url,delete t.subscriptions;var v=mitt(),g={apiReadySended:!1};return sdkInstance={url:s,iframe:d,version:"1.1.8",iframeReady:!1,tokenData:null,commandBars:null,tabs:{getTabs:function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,f];case 1:return e.sent(),[2,apiBasicChannel({api:"tab.getTabs"})]}})})},switchTab:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),[2,apiBasicChannel({api:"tab.switchTab",args:{tabKey:e}})]}})})}},setCooperUserColor:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),[2,apiBasicChannel({api:"setCooperUserColor",args:e})]}})})},setToken:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),sdkInstance.tokenData=e,sendMsgToWps({eventName:"setToken",data:e}),[2]}})})},ready:function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return g.apiReadySended?[3,2]:[4,p];case 1:e.sent(),g.apiReadySended=!0,sendMsgToWps({eventName:"api.ready"}),e.label=2;case 2:return[4,b];case 3:return e.sent(),[2,new Promise(function(e){return setTimeout(function(){return e(null==sdkInstance?void 0:sdkInstance.Application)},0)})]}})})},destroy:function(){d.destroy(),Message.empty(),sdkInstance=null,destroyApplication()},save:function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,f];case 1:return e.sent(),[2,apiChannelOld({api:"save"})]}})})},setCommandBars:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),setCommandBars(e),[2]}})})},updateConfig:function(e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),e.commandBars?(console.warn("Deprecated: `updateConfig()` 方法即将废弃，请使用`setCommandBars()`代替`updateConfig()`更新`commandBars`配置。"),[4,setCommandBars(e.commandBars)]):[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},executeCommandBar:function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,f];case 1:return t.sent(),setCommandBars([{cmbId:e,attributes:[{name:"click",value:!0}]}]),[2]}})})},on:function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(a){switch(a.label){case 0:return[4,f];case 1:return a.sent(),n=e,e===EVENT_TYPES.fileSaved&&console.warn("fileSaved事件监听即将弃用， 推荐使用fileStatus进行文件状态的监听"),e===EVENT_TYPES.fullscreenChange&&(n="fullscreenchange"),handleBasicEvent(d,n,"on"),v.on(e,t),[2]}})})},off:function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,f];case 1:return n.sent(),handleBasicEvent(d,e,"off"),v.off(e,t),[2]}})})}},handleFunctionConfig(t,o,c,l,g,u),listener(sdkInstance,v,t,a,g,d,h),sdkInstance}catch(e){console.error(e)}}function handleFunctionConfig(e,t,n,a,r,i){t&&isFunction(t)&&(r.refreshToken=t,e.refreshToken={eventName:EVENT_NAME.getToken}),i&&isFunction(i)&&(r.getClipboardData=i,e.getClipboardData={eventName:EVENT_NAME.getClipboardData}),n&&isFunction(n)&&(r.onToast=n,e.onToast={eventName:EVENT_NAME.onToast}),a&&isFunction(a)&&(r.onHyperLinkOpen=a,e.onHyperLinkOpen={eventName:EVENT_NAME.onHyperLinkOpen})}function handleBasicEvent(e,t,n){var a=t;if(!["error","fileOpen"].includes(a)){"fileSaved"===a&&(a="fileStatus");var r={eventName:"basic.event",data:{eventName:a,action:n}};e.contentWindow.postMessage(JSON.stringify(r),"*")}}function handleParenFullscreenEvent(e,t){if(0===e){var n=document;(n.exitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen||n.webkitCancelFullScreen||n.webkitExitFullscreen).call(document)}else if(1===e){(t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen).call(t)}}function handleBrowserViewFullscreen(e,t,n,a){0===e?t.style="position: static; width: "+n.width+"; height: "+n.height:1===e&&(t.style="position: absolute; width: 100%; height: 100%"),a&&dispatchFullScreenChange({status:e})}console.log("WebOfficeSDK JS-SDK V1.1.8");var wps=Object.freeze({__proto__:null,listener:listener,config:config});window.WPS=wps;var config$1=config,index={config:config$1};exports.config=config$1,exports.default=index;
